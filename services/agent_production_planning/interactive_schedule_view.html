<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Production Scheduler</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.25/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.2.2/css/buttons.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.9/css/responsive.bootstrap5.min.css">
    <style>
        body { 
            font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; 
            background-color: #f5f7fa;
            color: #333;
        }
        .container-fluid {
            max-width: 1400px;
            margin: 0 auto;
        }
        .dashboard {
            margin-bottom: 20px; 
            padding: 15px; 
            border-radius: 8px; 
            background: #fff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border: 1px solid #eaeaea;
        }
        .dashboard h3 {
            margin-top: 0;
            font-weight: 600;
            color: #3a3a3a;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
            margin-bottom: 12px;
            font-size: 16px;
        }
        table.dataTable {
            border-collapse: separate !important;
            border-spacing: 0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            font-size: 10px;  /* Smaller base font size */
            width: 100%;
            table-layout: fixed;  /* Fixed table layout for better control */
            margin: 0;
            padding: 0;
        }
        
        table.dataTable th {
            font-size: 9px;  /* Extra small header font */
            padding: 1px 2px !important;  /* Minimal padding */
            font-weight: 600;
            white-space: nowrap;  /* Prevent wrapping in headers */
            overflow: hidden;
            text-overflow: ellipsis;  /* Show ellipsis for overflow */
        }
        
        table.dataTable td {
            font-size: 10px;  /* Extra small cell font */
            padding: 1px 2px !important;  /* Minimal padding */
            overflow: hidden;
            text-overflow: ellipsis;  /* Show ellipsis for overflow */
            white-space: normal;  /* Allow text to wrap */
        }
        
        /* Set specific column widths based on content - reduced to fit all columns */
        table.dataTable th:nth-child(1), table.dataTable td:nth-child(1) { width: 40px; } /* PLAN_DATE */
        table.dataTable th:nth-child(2), table.dataTable td:nth-child(2) { width: 55px; } /* LCD_DATE */
        table.dataTable th:nth-child(3), table.dataTable td:nth-child(3) { width: 60px; } /* JOB */
        table.dataTable th:nth-child(4), table.dataTable td:nth-child(4) { width: 100px; } /* UNIQUE_JOB_ID */
        table.dataTable th:nth-child(5), table.dataTable td:nth-child(5) { width: 40px; } /* RSC_LOCATION */
        table.dataTable th:nth-child(6), table.dataTable td:nth-child(6) { width: 55px; } /* RSC_CODE */
        table.dataTable th:nth-child(7), table.dataTable td:nth-child(7) { width: 35px; } /* NUMBER_OPERATOR */
        table.dataTable th:nth-child(8), table.dataTable td:nth-child(8) { width: 45px; } /* JOB_QUANTITY */
        table.dataTable th:nth-child(9), table.dataTable td:nth-child(9) { width: 45px; } /* EXPECT_OUTPUT_PER_HOUR */
        table.dataTable th:nth-child(10), table.dataTable td:nth-child(10) { width: 25px; } /* PRIORITY */
        table.dataTable th:nth-child(11), table.dataTable td:nth-child(11) { width: 40px; } /* HOURS_NEED */
        table.dataTable th:nth-child(12), table.dataTable td:nth-child(12) { width: 45px; } /* SETTING_HOURS */
        table.dataTable th:nth-child(13), table.dataTable td:nth-child(13) { width: 45px; } /* BREAK_HOURS */
        table.dataTable th:nth-child(14), table.dataTable td:nth-child(14) { width: 35px; } /* NO_PROD */
        table.dataTable th:nth-child(15), table.dataTable td:nth-child(15) { width: 65px; } /* START_DATE */
        table.dataTable th:nth-child(16), table.dataTable td:nth-child(16) { width: 55px; } /* ACCUMULATED_DAILY_OUTPUT */
        table.dataTable th:nth-child(17), table.dataTable td:nth-child(17) { width: 45px; } /* BALANCE_QUANTITY */
        table.dataTable th:nth-child(18), table.dataTable td:nth-child(18) { width: 65px; } /* START_TIME */
        table.dataTable th:nth-child(19), table.dataTable td:nth-child(19) { width: 65px; } /* END_TIME */
        table.dataTable th:nth-child(20), table.dataTable td:nth-child(20) { width: 35px; } /* BAL_HR */
        table.dataTable th:nth-child(21), table.dataTable td:nth-child(21) { width: 50px; } /* BUFFER_STATUS */
        
        /* Make table container scrollable horizontally */
        .table-container {
            overflow-x: visible;
            margin-bottom: 30px;
            width: 100%;
        }
        
        /* Highlight row on hover for better readability */
        table.dataTable tbody tr:hover {
            background-color: rgba(0, 123, 255, 0.05) !important;
        }
        
        /* Status styles */
        .status-critical { background-color: rgba(255, 0, 0, 0.05); }
        .status-warning { background-color: rgba(255, 190, 0, 0.05); }
        .status-caution { background-color: rgba(128, 0, 128, 0.05); }
        .status-ok { background-color: rgba(0, 128, 0, 0.05); }
        
        .status-badge {
            display: inline-block;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 600;
            text-align: center;
            width: 100%;
            font-size: 10px;
        }
        
        .badge-critical { background-color: #ffcccc; color: #cc0000; border: 1px solid #ff8080; }
        .badge-warning { background-color: #fff2cc; color: #b38600; border: 1px solid #ffdb4d; }
        .badge-caution { background-color: #f0d6f0; color: #800080; border: 1px solid #d699d6; }
        .badge-ok { background-color: #d6f0d6; color: #006600; border: 1px solid #99d699; }
    </style>
</head>
<body>
    <div class="container-fluid" style="max-width: 100%; padding: 10px;">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h1 class="mb-0" style="font-size: 20px;"><i class="bi bi-calendar-check me-2"></i>Production Scheduler</h1>
            <div>
                <button class="btn btn-sm btn-primary" onclick="window.print()">
                    <i class="bi bi-printer me-1"></i> Print
                </button>
                <button class="btn btn-sm btn-outline-secondary ms-2" onclick="exportTableToCSV('production_schedule.csv')">
                    <i class="bi bi-download me-1"></i> Export
                </button>
            </div>
        </div>
        
        <div class="dashboard row">
            <div class="col-md-6">
                <h3>Schedule Overview</h3>
                <p style="font-size: 12px;"><strong>Total Jobs:</strong> 38</p>
                <p style="font-size: 12px;"><strong>Date Range:</strong> 2025-03-28 16:36 to 2025-05-14 18:30</p>
                <p style="font-size: 12px;"><strong>Total Duration:</strong> 1692.7287756132753 hours</p>
            </div>
            <div class="col-md-6">
                <h3>Buffer Status</h3>
                <div class="d-flex flex-column gap-2">
                    <div class="d-flex align-items-center">
                        <div class="status-badge badge-critical me-2" style="width: 80px;">Late</div>
                        <div class="progress flex-grow-1" style="height: 16px;">
                            <div class="progress-bar bg-danger" role="progressbar" 
                                style="width: 18.421052631578945%;" 
                                aria-valuenow="7" 
                                aria-valuemin="0" aria-valuemax="38">
                                7 jobs
                            </div>
                        </div>
                    </div>
                    <div class="d-flex align-items-center">
                        <div class="status-badge badge-warning me-2" style="width: 80px;">Warning</div>
                        <div class="progress flex-grow-1" style="height: 16px;">
                            <div class="progress-bar bg-warning text-dark" role="progressbar" 
                                style="width: 7.894736842105263%;" 
                                aria-valuenow="3" 
                                aria-valuemin="0" aria-valuemax="38">
                                3 jobs
                            </div>
                        </div>
                    </div>
                    <div class="d-flex align-items-center">
                        <div class="status-badge badge-caution me-2" style="width: 80px;">Caution</div>
                        <div class="progress flex-grow-1" style="height: 16px;">
                            <div class="progress-bar" role="progressbar" style="background-color: purple; width: 34.21052631578947%;" 
                                aria-valuenow="13" 
                                aria-valuemin="0" aria-valuemax="38">
                                13 jobs
                            </div>
                        </div>
                    </div>
                    <div class="d-flex align-items-center">
                        <div class="status-badge badge-ok me-2" style="width: 80px;">OK</div>
                        <div class="progress flex-grow-1" style="height: 16px;">
                            <div class="progress-bar bg-success" role="progressbar" 
                                style="width: 39.473684210526315%;" 
                                aria-valuenow="15" 
                                aria-valuemin="0" aria-valuemax="38">
                                15 jobs
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="table-container">
            <h2 style="font-size: 16px; margin-bottom: 10px;">Production Jobs</h2>
            <table id="scheduleTable" class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th>PLAN_DATE</th>
                        <th>LCD_DATE</th>
                        <th>JOB</th>
                        <th>UNIQUE_JOB_ID</th>
                        <th>RSC_LOCATION</th>
                        <th>RSC_CODE</th>
                        <th>NUMBER_OPERATOR</th>
                        <th>JOB_QUANTITY</th>
                        <th>EXPECT_OUTPUT_PER_HOUR</th>
                        <th>PRIORITY</th>
                        <th>HOURS_NEED</th>
                        <th>SETTING_HOURS</th>
                        <th>BREAK_HOURS</th>
                        <th>NO_PROD</th>
                        <th>START_DATE</th>
                        <th>ACCUMULATED_DAILY_OUTPUT</th>
                        <th>BALANCE_QUANTITY</th>
                        <th>START_TIME</th>
                        <th>END_TIME</th>
                        <th>BAL_HR</th>
                        <th>BUFFER_STATUS</th>
                    </tr>
                </thead>
                <tbody>

                    <tr class="status-caution">
                        <td title="15/03/25">15/03/25</td>
                        <td title="15/04/25 17:00">15/04/25 17:00</td>
                        <td title="JOST888001">JOST888001</td>
                        <td title="JOST888001_CP88-888-P01-08">JOST888001_CP88-888-P01-08</td>
                        <td title="TR">TR</td>
                        <td title="PAINTING">PAINTING</td>
                        <td title="1">1</td>
                        <td title="10000">10000</td>
                        <td title="500">500</td>
                        <td title="2">2</td>
                        <td title="20.0">20.0</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="6.0">6.0</td>
                        <td title="2025-04-12 08:00">2025-04-12 08:00</td>
                        <td title="1000.0">1000.0</td>
                        <td title="9000">9000</td>
                        <td title="2025-04-12 08:00">2025-04-12 08:00</td>
                        <td title="2025-04-13 04:00">2025-04-13 04:00</td>
                        <td title="61.0">61.0</td>
                        <td><div class="status-badge badge-caution">Caution</div></td>
                    </tr>
                    <tr class="status-caution">
                        <td title="15/03/25">15/03/25</td>
                        <td title="15/04/25 17:00">15/04/25 17:00</td>
                        <td title="JOST888002">JOST888002</td>
                        <td title="JOST888002_CP88-888-P02-09">JOST888002_CP88-888-P02-09</td>
                        <td title="TR">TR</td>
                        <td title="PAINTING">PAINTING</td>
                        <td title="1">1</td>
                        <td title="20000">20000</td>
                        <td title="600">600</td>
                        <td title="2">2</td>
                        <td title="33.3">33.3</td>
                        <td title="2.0">2.0</td>
                        <td title="2.0">2.0</td>
                        <td title="7.0">7.0</td>
                        <td title=""></td>
                        <td title="2000.0">2000.0</td>
                        <td title="18000">18000</td>
                        <td title="2025-04-13 04:00">2025-04-13 04:00</td>
                        <td title="2025-04-14 13:20">2025-04-14 13:20</td>
                        <td title="27.7">27.7</td>
                        <td><div class="status-badge badge-caution">Caution</div></td>
                    </tr>
                    <tr class="status-warning">
                        <td title="15/03/25">15/03/25</td>
                        <td title="15/04/25 17:00">15/04/25 17:00</td>
                        <td title="JOST888003">JOST888003</td>
                        <td title="JOST888003_CP88-888-P03-08">JOST888003_CP88-888-P03-08</td>
                        <td title="TR">TR</td>
                        <td title="PAINTING">PAINTING</td>
                        <td title="1">1</td>
                        <td title="10000">10000</td>
                        <td title="700">700</td>
                        <td title="2">2</td>
                        <td title="14.3">14.3</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="3000.0">3000.0</td>
                        <td title="7000">7000</td>
                        <td title="2025-04-14 13:20">2025-04-14 13:20</td>
                        <td title="2025-04-15 03:37">2025-04-15 03:37</td>
                        <td title="13.4">13.4</td>
                        <td><div class="status-badge badge-warning">Warning</div></td>
                    </tr>
                    <tr class="status-critical">
                        <td title="16/03/25">16/03/25</td>
                        <td title="15/04/25 17:00">15/04/25 17:00</td>
                        <td title="JOST888004">JOST888004</td>
                        <td title="JOST888004_CP88-888-P04-10">JOST888004_CP88-888-P04-10</td>
                        <td title="TR">TR</td>
                        <td title="PAINTING">PAINTING</td>
                        <td title="1">1</td>
                        <td title="15000">15000</td>
                        <td title="800">800</td>
                        <td title="2">2</td>
                        <td title="18.8">18.8</td>
                        <td title="2.0">2.0</td>
                        <td title="2.0">2.0</td>
                        <td title="5.0">5.0</td>
                        <td title=""></td>
                        <td title="4000.0">4000.0</td>
                        <td title="11000">11000</td>
                        <td title="2025-04-15 03:37">2025-04-15 03:37</td>
                        <td title="2025-04-15 22:22">2025-04-15 22:22</td>
                        <td title="-5.4">-5.4</td>
                        <td><div class="status-badge badge-critical">Late</div></td>
                    </tr>
                    <tr class="status-critical">
                        <td title="16/03/25">16/03/25</td>
                        <td title="15/04/25 17:00">15/04/25 17:00</td>
                        <td title="JOST888005">JOST888005</td>
                        <td title="JOST888005_CP88-888-P05-10">JOST888005_CP88-888-P05-10</td>
                        <td title="TR">TR</td>
                        <td title="CHECKING">CHECKING</td>
                        <td title="1">1</td>
                        <td title="10000">10000</td>
                        <td title="900">900</td>
                        <td title="1">1</td>
                        <td title="11.1">11.1</td>
                        <td title="3.0">3.0</td>
                        <td title="2.0">2.0</td>
                        <td title="7.0">7.0</td>
                        <td title=""></td>
                        <td title="5000.0">5000.0</td>
                        <td title="5000">5000</td>
                        <td title="2025-04-15 22:22">2025-04-15 22:22</td>
                        <td title="2025-04-16 09:28">2025-04-16 09:28</td>
                        <td title="-16.5">-16.5</td>
                        <td><div class="status-badge badge-critical">Late</div></td>
                    </tr>
                    <tr class="status-critical">
                        <td title="16/03/25">16/03/25</td>
                        <td title="15/04/25 17:00">15/04/25 17:00</td>
                        <td title="JOST888006">JOST888006</td>
                        <td title="JOST888006_CP88-888-P06-18">JOST888006_CP88-888-P06-18</td>
                        <td title="ST-4">ST-4</td>
                        <td title="TW01">TW01</td>
                        <td title="1">1</td>
                        <td title="13000">13000</td>
                        <td title="1000">1000</td>
                        <td title="1">1</td>
                        <td title="13.0">13.0</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="3000.0">3000.0</td>
                        <td title="10000">10000</td>
                        <td title="2025-04-16 09:28">2025-04-16 09:28</td>
                        <td title="2025-04-16 22:28">2025-04-16 22:28</td>
                        <td title="-29.5">-29.5</td>
                        <td><div class="status-badge badge-critical">Late</div></td>
                    </tr>
                    <tr class="status-ok">
                        <td title="01/03/25">01/03/25</td>
                        <td title="01/05/25 07:00">01/05/25 07:00</td>
                        <td title="JOAW24090215">JOAW24090215</td>
                        <td title="JOAW24090215_CD11-027-P05-06">JOAW24090215_CD11-027-P05-06</td>
                        <td title="WN">WN</td>
                        <td title="TW01">TW01</td>
                        <td title="1">1</td>
                        <td title="10000">10000</td>
                        <td title="400">400</td>
                        <td title="3">3</td>
                        <td title="25.0">25.0</td>
                        <td title="8.0">8.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="9969.0">9969.0</td>
                        <td title="31">31</td>
                        <td title="2025-04-19 21:54">2025-04-19 21:54</td>
                        <td title="2025-04-20 22:54">2025-04-20 22:54</td>
                        <td title="248.1">248.1</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-critical">
                        <td title="01/03/25">01/03/25</td>
                        <td title="01/05/25 08:00">01/05/25 08:00</td>
                        <td title="JOST24120021">JOST24120021</td>
                        <td title="JOST24120021_CM10-009-P04-05">JOST24120021_CM10-009-P04-05</td>
                        <td title="AL">AL</td>
                        <td title="CHECKING">CHECKING</td>
                        <td title="1">1</td>
                        <td title="41613">41613</td>
                        <td title="1200">1200</td>
                        <td title="3">3</td>
                        <td title="34.7">34.7</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="17400.0">17400.0</td>
                        <td title="24213">24213</td>
                        <td title="2025-05-03 04:42">2025-05-03 04:42</td>
                        <td title="2025-05-04 15:22">2025-05-04 15:22</td>
                        <td title="-79.4">-79.4</td>
                        <td><div class="status-badge badge-critical">Late</div></td>
                    </tr>
                    <tr class="status-ok">
                        <td title="01/03/25">01/03/25</td>
                        <td title="01/05/25 10:00">01/05/25 10:00</td>
                        <td title="JOAW24120118">JOAW24120118</td>
                        <td title="JOAW24120118_CD11-026-P05-06">JOAW24120118_CD11-026-P05-06</td>
                        <td title="WN">WN</td>
                        <td title="TW01">TW01</td>
                        <td title="1">1</td>
                        <td title="15000">15000</td>
                        <td title="420">420</td>
                        <td title="3">3</td>
                        <td title="35.7">35.7</td>
                        <td title="1.0">1.0</td>
                        <td title="5.0">5.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="0.0">0.0</td>
                        <td title="15000">15000</td>
                        <td title="2025-04-16 22:28">2025-04-16 22:28</td>
                        <td title="2025-04-18 10:11">2025-04-18 10:11</td>
                        <td title="311.8">311.8</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-ok">
                        <td title="01/03/25">01/03/25</td>
                        <td title="01/05/25 11:00">01/05/25 11:00</td>
                        <td title="JOAW24120201">JOAW24120201</td>
                        <td title="JOAW24120201_CM03-001-P02-04">JOAW24120201_CM03-001-P02-04</td>
                        <td title="ST">ST</td>
                        <td title="VM04">VM04</td>
                        <td title="1">1</td>
                        <td title="100806">100806</td>
                        <td title="250">250</td>
                        <td title="3">3</td>
                        <td title="403.2">403.2</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="12.0">12.0</td>
                        <td title=""></td>
                        <td title="100806.0">100806.0</td>
                        <td title="0">0</td>
                        <td title="2025-03-28 16:36">2025-03-28 16:36</td>
                        <td title="2025-04-14 11:50">2025-04-14 11:50</td>
                        <td title="407.2">407.2</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-critical">
                        <td title="01/03/25">01/03/25</td>
                        <td title="01/05/25 12:00">01/05/25 12:00</td>
                        <td title="JOAW24120201">JOAW24120201</td>
                        <td title="JOAW24120201_CM03-001-P03-04">JOAW24120201_CM03-001-P03-04</td>
                        <td title="AL">AL</td>
                        <td title="CHECKING">CHECKING</td>
                        <td title="1">1</td>
                        <td title="100806">100806</td>
                        <td title="250">250</td>
                        <td title="3">3</td>
                        <td title="403.2">403.2</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="57547.0">57547.0</td>
                        <td title="43259">43259</td>
                        <td title="2025-04-16 09:28">2025-04-16 09:28</td>
                        <td title="2025-05-03 04:42">2025-05-03 04:42</td>
                        <td title="-40.7">-40.7</td>
                        <td><div class="status-badge badge-critical">Late</div></td>
                    </tr>
                    <tr class="status-ok">
                        <td title="01/03/25">01/03/25</td>
                        <td title="01/05/25 13:00">01/05/25 13:00</td>
                        <td title="JOST24120090">JOST24120090</td>
                        <td title="JOST24120090_CP08-544-P01-02">JOST24120090_CP08-544-P01-02</td>
                        <td title="ST">ST</td>
                        <td title="STICK LABEL">STICK LABEL</td>
                        <td title="1">1</td>
                        <td title="1100">1100</td>
                        <td title="30">30</td>
                        <td title="1">1</td>
                        <td title="36.7">36.7</td>
                        <td title="2.0">2.0</td>
                        <td title="2.0">2.0</td>
                        <td title="1.0">1.0</td>
                        <td title=""></td>
                        <td title="428.0">428.0</td>
                        <td title="672">672</td>
                        <td title="2025-03-28 16:36">2025-03-28 16:36</td>
                        <td title="2025-03-30 05:16">2025-03-30 05:16</td>
                        <td title="775.7">775.7</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-ok">
                        <td title="01/03/25">01/03/25</td>
                        <td title="01/05/25 14:00">01/05/25 14:00</td>
                        <td title="JOST24120092">JOST24120092</td>
                        <td title="JOST24120092_CP08-545-P01-02">JOST24120092_CP08-545-P01-02</td>
                        <td title="ST">ST</td>
                        <td title="STICK LABEL">STICK LABEL</td>
                        <td title="1">1</td>
                        <td title="500">500</td>
                        <td title="18">18</td>
                        <td title="3">3</td>
                        <td title="27.8">27.8</td>
                        <td title="3.0">3.0</td>
                        <td title="2.0">2.0</td>
                        <td title="2.0">2.0</td>
                        <td title=""></td>
                        <td title="0.0">0.0</td>
                        <td title="500">500</td>
                        <td title="2025-03-30 05:16">2025-03-30 05:16</td>
                        <td title="2025-03-31 09:03">2025-03-31 09:03</td>
                        <td title="748.9">748.9</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-critical">
                        <td title="01/03/25">01/03/25</td>
                        <td title="01/05/25 15:00">01/05/25 15:00</td>
                        <td title="JOST24120047">JOST24120047</td>
                        <td title="JOST24120047_CP08-046-P03-04">JOST24120047_CP08-046-P03-04</td>
                        <td title="AL">AL</td>
                        <td title="CHECKING">CHECKING</td>
                        <td title="1">1</td>
                        <td title="30120">30120</td>
                        <td title="1800">1800</td>
                        <td title="3">3</td>
                        <td title="16.7">16.7</td>
                        <td title="4.0">4.0</td>
                        <td title="3.0">3.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="0.0">0.0</td>
                        <td title="30120">30120</td>
                        <td title="2025-05-04 15:22">2025-05-04 15:22</td>
                        <td title="2025-05-05 08:06">2025-05-05 08:06</td>
                        <td title="-89.1">-89.1</td>
                        <td><div class="status-badge badge-critical">Late</div></td>
                    </tr>
                    <tr class="status-ok">
                        <td title="01/03/25">01/03/25</td>
                        <td title="01/05/25 16:00">01/05/25 16:00</td>
                        <td title="JOTP24110201">JOTP24110201</td>
                        <td title="JOTP24110201_CP08-553-P05-07">JOTP24110201_CP08-553-P05-07</td>
                        <td title="TR">TR</td>
                        <td title="PAINTING">PAINTING</td>
                        <td title="1">1</td>
                        <td title="252">252</td>
                        <td title="12">12</td>
                        <td title="1">1</td>
                        <td title="21.0">21.0</td>
                        <td title="5.0">5.0</td>
                        <td title="4.0">4.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="211.0">211.0</td>
                        <td title="41">41</td>
                        <td title="2025-04-15 22:22">2025-04-15 22:22</td>
                        <td title="2025-04-16 19:22">2025-04-16 19:22</td>
                        <td title="356.6">356.6</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-ok">
                        <td title="01/03/25">01/03/25</td>
                        <td title="01/05/25 17:00">01/05/25 17:00</td>
                        <td title="JOTP24110201">JOTP24110201</td>
                        <td title="JOTP24110201_CP08-553-P06-07">JOTP24110201_CP08-553-P06-07</td>
                        <td title="TR">TR</td>
                        <td title="PACK & LABEL">PACK & LABEL</td>
                        <td title="1">1</td>
                        <td title="252">252</td>
                        <td title="12">12</td>
                        <td title="1">1</td>
                        <td title="21.0">21.0</td>
                        <td title="6.0">6.0</td>
                        <td title="5.0">5.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="182.0">182.0</td>
                        <td title="70">70</td>
                        <td title="2025-04-16 19:22">2025-04-16 19:22</td>
                        <td title="2025-04-17 16:22">2025-04-17 16:22</td>
                        <td title="336.6">336.6</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-ok">
                        <td title="18/03/25">18/03/25</td>
                        <td title="02/05/25 12:59">02/05/25 12:59</td>
                        <td title="JOST24120179">JOST24120179</td>
                        <td title="JOST24120179_CP08-289-P04-06">JOST24120179_CP08-289-P04-06</td>
                        <td title="ST-4">ST-4</td>
                        <td title="TP08">TP08</td>
                        <td title="1">1</td>
                        <td title="28632">28632</td>
                        <td title="360">360</td>
                        <td title="3">3</td>
                        <td title="79.5">79.5</td>
                        <td title="7.0">7.0</td>
                        <td title="6.0">6.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="5990.0">5990.0</td>
                        <td title="22642">22642</td>
                        <td title="2025-03-28 16:36">2025-03-28 16:36</td>
                        <td title="2025-04-01 00:08">2025-04-01 00:08</td>
                        <td title="756.9">756.9</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-critical">
                        <td title="18/03/25">18/03/25</td>
                        <td title="03/05/25 12:59">03/05/25 12:59</td>
                        <td title="JOST24120179">JOST24120179</td>
                        <td title="JOST24120179_CP08-289-P05-06">JOST24120179_CP08-289-P05-06</td>
                        <td title="AL">AL</td>
                        <td title="CHECKING">CHECKING</td>
                        <td title="1">1</td>
                        <td title="28632">28632</td>
                        <td title="360">360</td>
                        <td title="3">3</td>
                        <td title="79.5">79.5</td>
                        <td title="1.0">1.0</td>
                        <td title="7.0">7.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="5990.0">5990.0</td>
                        <td title="22642">22642</td>
                        <td title="2025-05-05 08:06">2025-05-05 08:06</td>
                        <td title="2025-05-08 15:38">2025-05-08 15:38</td>
                        <td title="-122.6">-122.6</td>
                        <td><div class="status-badge badge-critical">Late</div></td>
                    </tr>
                    <tr class="status-caution">
                        <td title="18/03/25">18/03/25</td>
                        <td title="04/05/25 12:59">04/05/25 12:59</td>
                        <td title="JOST24120433">JOST24120433</td>
                        <td title="JOST24120433_CH04-002-P01-07">JOST24120433_CH04-002-P01-07</td>
                        <td title="ST-3">ST-3</td>
                        <td title="PP25">PP25</td>
                        <td title="1">1</td>
                        <td title="5900">5900</td>
                        <td title="300">300</td>
                        <td title="3">3</td>
                        <td title="19.7">19.7</td>
                        <td title="1.0">1.0</td>
                        <td title="8.0">8.0</td>
                        <td title="8.0">8.0</td>
                        <td title="2025-05-01 08:00">2025-05-01 08:00</td>
                        <td title="0.0">0.0</td>
                        <td title="5900">5900</td>
                        <td title="2025-05-01 08:00">2025-05-01 08:00</td>
                        <td title="2025-05-02 03:40">2025-05-02 03:40</td>
                        <td title="57.3">57.3</td>
                        <td><div class="status-badge badge-caution">Caution</div></td>
                    </tr>
                    <tr class="status-caution">
                        <td title="18/03/25">18/03/25</td>
                        <td title="05/05/25 12:59">05/05/25 12:59</td>
                        <td title="JOST24120433">JOST24120433</td>
                        <td title="JOST24120433_CH04-002-P02-07">JOST24120433_CH04-002-P02-07</td>
                        <td title="ST-3">ST-3</td>
                        <td title="PP26-110T">PP26-110T</td>
                        <td title="1">1</td>
                        <td title="5900">5900</td>
                        <td title="300">300</td>
                        <td title="3">3</td>
                        <td title="19.7">19.7</td>
                        <td title="1.0">1.0</td>
                        <td title="9.0">9.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="0.0">0.0</td>
                        <td title="5900">5900</td>
                        <td title="2025-05-02 03:40">2025-05-02 03:40</td>
                        <td title="2025-05-02 23:20">2025-05-02 23:20</td>
                        <td title="61.7">61.7</td>
                        <td><div class="status-badge badge-caution">Caution</div></td>
                    </tr>
                    <tr class="status-caution">
                        <td title="18/03/25">18/03/25</td>
                        <td title="06/05/25 12:59">06/05/25 12:59</td>
                        <td title="JOST24120433">JOST24120433</td>
                        <td title="JOST24120433_CH04-002-P03-07">JOST24120433_CH04-002-P03-07</td>
                        <td title="ST-3">ST-3</td>
                        <td title="PP20">PP20</td>
                        <td title="1">1</td>
                        <td title="5900">5900</td>
                        <td title="300">300</td>
                        <td title="3">3</td>
                        <td title="19.7">19.7</td>
                        <td title="1.0">1.0</td>
                        <td title="10.0">10.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="0.0">0.0</td>
                        <td title="5900">5900</td>
                        <td title="2025-05-02 23:20">2025-05-02 23:20</td>
                        <td title="2025-05-03 19:00">2025-05-03 19:00</td>
                        <td title="66.0">66.0</td>
                        <td><div class="status-badge badge-caution">Caution</div></td>
                    </tr>
                    <tr class="status-caution">
                        <td title="18/03/25">18/03/25</td>
                        <td title="07/05/25 12:59">07/05/25 12:59</td>
                        <td title="JOST24120433">JOST24120433</td>
                        <td title="JOST24120433_CH04-002-P04-07">JOST24120433_CH04-002-P04-07</td>
                        <td title="ST-3">ST-3</td>
                        <td title="PP28-110T">PP28-110T</td>
                        <td title="1">1</td>
                        <td title="5900">5900</td>
                        <td title="300">300</td>
                        <td title="3">3</td>
                        <td title="19.7">19.7</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="0.0">0.0</td>
                        <td title="5900">5900</td>
                        <td title="2025-05-03 19:00">2025-05-03 19:00</td>
                        <td title="2025-05-04 14:40">2025-05-04 14:40</td>
                        <td title="70.3">70.3</td>
                        <td><div class="status-badge badge-caution">Caution</div></td>
                    </tr>
                    <tr class="status-ok">
                        <td title="18/03/25">18/03/25</td>
                        <td title="08/05/25 12:59">08/05/25 12:59</td>
                        <td title="JOST24120433">JOST24120433</td>
                        <td title="JOST24120433_CH04-002-P05-07">JOST24120433_CH04-002-P05-07</td>
                        <td title="ST-3">ST-3</td>
                        <td title="SW01">SW01</td>
                        <td title="1">1</td>
                        <td title="5900">5900</td>
                        <td title="300">300</td>
                        <td title="3">3</td>
                        <td title="19.7">19.7</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="0.0">0.0</td>
                        <td title="5900">5900</td>
                        <td title="2025-05-04 14:40">2025-05-04 14:40</td>
                        <td title="2025-05-05 10:20">2025-05-05 10:20</td>
                        <td title="74.7">74.7</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-caution">
                        <td title="18/03/25">18/03/25</td>
                        <td title="09/05/25 12:59">09/05/25 12:59</td>
                        <td title="JOST24120433">JOST24120433</td>
                        <td title="JOST24120433_CH04-002-P06-07">JOST24120433_CH04-002-P06-07</td>
                        <td title="ST-1">ST-1</td>
                        <td title="OPT PAINTING">OPT PAINTING</td>
                        <td title="1">1</td>
                        <td title="5900">5900</td>
                        <td title="120">120</td>
                        <td title="3">3</td>
                        <td title="49.2">49.2</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="0.0">0.0</td>
                        <td title="5900">5900</td>
                        <td title="2025-05-05 10:20">2025-05-05 10:20</td>
                        <td title="2025-05-07 11:30">2025-05-07 11:30</td>
                        <td title="49.5">49.5</td>
                        <td><div class="status-badge badge-caution">Caution</div></td>
                    </tr>
                    <tr class="status-caution">
                        <td title="18/03/25">18/03/25</td>
                        <td title="10/05/25 12:59">10/05/25 12:59</td>
                        <td title="JOST24120408">JOST24120408</td>
                        <td title="JOST24120408_CT10-001-P01-06">JOST24120408_CT10-001-P01-06</td>
                        <td title="ST-3">ST-3</td>
                        <td title="PP09-160T">PP09-160T</td>
                        <td title="1">1</td>
                        <td title="6080">6080</td>
                        <td title="330">330</td>
                        <td title="3">3</td>
                        <td title="18.4">18.4</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title="2025-05-08 10:00">2025-05-08 10:00</td>
                        <td title="6042.0">6042.0</td>
                        <td title="38">38</td>
                        <td title="2025-05-08 10:00">2025-05-08 10:00</td>
                        <td title="2025-05-09 04:25">2025-05-09 04:25</td>
                        <td title="32.6">32.6</td>
                        <td><div class="status-badge badge-caution">Caution</div></td>
                    </tr>
                    <tr class="status-caution">
                        <td title="18/03/25">18/03/25</td>
                        <td title="11/05/25 12:59">11/05/25 12:59</td>
                        <td title="JOST24120408">JOST24120408</td>
                        <td title="JOST24120408_CT10-001-P02-06">JOST24120408_CT10-001-P02-06</td>
                        <td title="ST-3">ST-3</td>
                        <td title="PP18">PP18</td>
                        <td title="1">1</td>
                        <td title="6080">6080</td>
                        <td title="330">330</td>
                        <td title="3">3</td>
                        <td title="18.4">18.4</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="6042.0">6042.0</td>
                        <td title="38">38</td>
                        <td title="2025-05-09 04:25">2025-05-09 04:25</td>
                        <td title="2025-05-09 22:50">2025-05-09 22:50</td>
                        <td title="38.2">38.2</td>
                        <td><div class="status-badge badge-caution">Caution</div></td>
                    </tr>
                    <tr class="status-caution">
                        <td title="18/03/25">18/03/25</td>
                        <td title="12/05/25 12:59">12/05/25 12:59</td>
                        <td title="JOST24120408">JOST24120408</td>
                        <td title="JOST24120408_CT10-001-P03-06">JOST24120408_CT10-001-P03-06</td>
                        <td title="ST-3">ST-3</td>
                        <td title="PP17-110T">PP17-110T</td>
                        <td title="1">1</td>
                        <td title="6080">6080</td>
                        <td title="330">330</td>
                        <td title="3">3</td>
                        <td title="18.4">18.4</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="6042.0">6042.0</td>
                        <td title="38">38</td>
                        <td title="2025-05-09 22:50">2025-05-09 22:50</td>
                        <td title="2025-05-10 17:16">2025-05-10 17:16</td>
                        <td title="43.7">43.7</td>
                        <td><div class="status-badge badge-caution">Caution</div></td>
                    </tr>
                    <tr class="status-caution">
                        <td title="18/03/25">18/03/25</td>
                        <td title="13/05/25 12:59">13/05/25 12:59</td>
                        <td title="JOST24120408">JOST24120408</td>
                        <td title="JOST24120408_CT10-001-P04-06">JOST24120408_CT10-001-P04-06</td>
                        <td title="ST-3">ST-3</td>
                        <td title="PP16-110T">PP16-110T</td>
                        <td title="1">1</td>
                        <td title="6080">6080</td>
                        <td title="330">330</td>
                        <td title="3">3</td>
                        <td title="18.4">18.4</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="6042.0">6042.0</td>
                        <td title="38">38</td>
                        <td title="2025-05-10 17:16">2025-05-10 17:16</td>
                        <td title="2025-05-11 11:41">2025-05-11 11:41</td>
                        <td title="49.3">49.3</td>
                        <td><div class="status-badge badge-caution">Caution</div></td>
                    </tr>
                    <tr class="status-ok">
                        <td title="18/03/25">18/03/25</td>
                        <td title="14/05/25 13:00">14/05/25 13:00</td>
                        <td title="JOAW24120383">JOAW24120383</td>
                        <td title="JOAW24120383_CP08-557-P08-09">JOAW24120383_CP08-557-P08-09</td>
                        <td title="AL">AL</td>
                        <td title="CHECKING">CHECKING</td>
                        <td title="1">1</td>
                        <td title="1000">1000</td>
                        <td title="15">15</td>
                        <td title="3">3</td>
                        <td title="66.7">66.7</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="0.0">0.0</td>
                        <td title="1000">1000</td>
                        <td title="2025-05-08 15:38">2025-05-08 15:38</td>
                        <td title="2025-05-11 10:18">2025-05-11 10:18</td>
                        <td title="74.7">74.7</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-caution">
                        <td title="18/03/25">18/03/25</td>
                        <td title="14/05/25 13:00">14/05/25 13:00</td>
                        <td title="JOST24120408">JOST24120408</td>
                        <td title="JOST24120408_CT10-001-P05-06">JOST24120408_CT10-001-P05-06</td>
                        <td title="ST-3">ST-3</td>
                        <td title="PP27-110T">PP27-110T</td>
                        <td title="2">2</td>
                        <td title="6080">6080</td>
                        <td title="330">330</td>
                        <td title="3">3</td>
                        <td title="18.4">18.4</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="6042.0">6042.0</td>
                        <td title="38">38</td>
                        <td title="2025-05-11 11:41">2025-05-11 11:41</td>
                        <td title="2025-05-12 00:43">2025-05-12 00:43</td>
                        <td title="60.3">60.3</td>
                        <td><div class="status-badge badge-caution">Caution</div></td>
                    </tr>
                    <tr class="status-ok">
                        <td title="18/03/25">18/03/25</td>
                        <td title="14/05/25 13:00">14/05/25 13:00</td>
                        <td title="JOAW24120119">JOAW24120119</td>
                        <td title="JOAW24120119_CD11-026-P05-06">JOAW24120119_CD11-026-P05-06</td>
                        <td title="WN">WN</td>
                        <td title="TW01">TW01</td>
                        <td title="1">1</td>
                        <td title="15000">15000</td>
                        <td title="420">420</td>
                        <td title="3">3</td>
                        <td title="35.7">35.7</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="0.0">0.0</td>
                        <td title="15000">15000</td>
                        <td title="2025-04-18 10:11">2025-04-18 10:11</td>
                        <td title="2025-04-19 21:54">2025-04-19 21:54</td>
                        <td title="591.1">591.1</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-warning">
                        <td title="20/03/25">20/03/25</td>
                        <td title="15/05/25 08:00">15/05/25 08:00</td>
                        <td title="JOST24120338">JOST24120338</td>
                        <td title="JOST24120338_CP08-353&CP08-354-P02-05">JOST24120338_CP08-353&CP08-354-P02-05</td>
                        <td title="ST-4">ST-4</td>
                        <td title="PP25-160T">PP25-160T</td>
                        <td title="1">1</td>
                        <td title="2800">2800</td>
                        <td title="300">300</td>
                        <td title="3">3</td>
                        <td title="9.3">9.3</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="0.0">0.0</td>
                        <td title="2800">2800</td>
                        <td title="2025-05-13 23:50">2025-05-13 23:50</td>
                        <td title="2025-05-14 09:10">2025-05-14 09:10</td>
                        <td title="22.8">22.8</td>
                        <td><div class="status-badge badge-warning">Warning</div></td>
                    </tr>
                    <tr class="status-ok">
                        <td title="18/03/25">18/03/25</td>
                        <td title="15/05/25 08:00">15/05/25 08:00</td>
                        <td title="JOST24120359">JOST24120359</td>
                        <td title="JOST24120359_CP08-504A-P02-04">JOST24120359_CP08-504A-P02-04</td>
                        <td title="ST-4">ST-4</td>
                        <td title="PP24-160T">PP24-160T</td>
                        <td title="1">1</td>
                        <td title="216">216</td>
                        <td title="300">300</td>
                        <td title="3">3</td>
                        <td title="0.7">0.7</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="0.0">0.0</td>
                        <td title="216">216</td>
                        <td title="2025-03-28 16:36">2025-03-28 16:36</td>
                        <td title="2025-03-28 17:19">2025-03-28 17:19</td>
                        <td title="1142.7">1142.7</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-ok">
                        <td title="18/03/25">18/03/25</td>
                        <td title="15/05/25 08:00">15/05/25 08:00</td>
                        <td title="JOST24120359">JOST24120359</td>
                        <td title="JOST24120359_CP08-504A-P03-04">JOST24120359_CP08-504A-P03-04</td>
                        <td title="ST-4">ST-4</td>
                        <td title="PP24-160T">PP24-160T</td>
                        <td title="1">1</td>
                        <td title="216">216</td>
                        <td title="300">300</td>
                        <td title="3">3</td>
                        <td title="0.7">0.7</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="0.0">0.0</td>
                        <td title="216">216</td>
                        <td title="2025-03-28 17:19">2025-03-28 17:19</td>
                        <td title="2025-03-28 18:03">2025-03-28 18:03</td>
                        <td title="1141.9">1141.9</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-ok">
                        <td title="18/03/25">18/03/25</td>
                        <td title="15/05/25 08:00">15/05/25 08:00</td>
                        <td title="JOST24120337">JOST24120337</td>
                        <td title="JOST24120337_CP08-352-P02-04">JOST24120337_CP08-352-P02-04</td>
                        <td title="ST-4">ST-4</td>
                        <td title="PP26-110T">PP26-110T</td>
                        <td title="1">1</td>
                        <td title="5440">5440</td>
                        <td title="360">360</td>
                        <td title="3">3</td>
                        <td title="15.1">15.1</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="0.0">0.0</td>
                        <td title="5440">5440</td>
                        <td title="2025-05-02 23:20">2025-05-02 23:20</td>
                        <td title="2025-05-03 14:26">2025-05-03 14:26</td>
                        <td title="281.6">281.6</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-ok">
                        <td title="18/03/25">18/03/25</td>
                        <td title="15/05/25 08:00">15/05/25 08:00</td>
                        <td title="JOST24120337">JOST24120337</td>
                        <td title="JOST24120337_CP08-352-P03-04">JOST24120337_CP08-352-P03-04</td>
                        <td title="ST-4">ST-4</td>
                        <td title="PP28-110T">PP28-110T</td>
                        <td title="1">1</td>
                        <td title="5440">5440</td>
                        <td title="360">360</td>
                        <td title="3">3</td>
                        <td title="15.1">15.1</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="0.0">0.0</td>
                        <td title="5440">5440</td>
                        <td title="2025-05-04 14:40">2025-05-04 14:40</td>
                        <td title="2025-05-05 05:46">2025-05-05 05:46</td>
                        <td title="242.2">242.2</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-caution">
                        <td title="20/03/25">20/03/25</td>
                        <td title="15/05/25 08:00">15/05/25 08:00</td>
                        <td title="JOST24120338">JOST24120338</td>
                        <td title="JOST24120338_CP08-353&CP08-354-P01-05">JOST24120338_CP08-353&CP08-354-P01-05</td>
                        <td title="SM">SM</td>
                        <td title="SM01">SM01</td>
                        <td title="1">1</td>
                        <td title="2800">2800</td>
                        <td title="480">480</td>
                        <td title="3">3</td>
                        <td title="5.8">5.8</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title="2025-05-13 18:00">2025-05-13 18:00</td>
                        <td title="0.0">0.0</td>
                        <td title="2800">2800</td>
                        <td title="2025-05-13 18:00">2025-05-13 18:00</td>
                        <td title="2025-05-13 23:50">2025-05-13 23:50</td>
                        <td title="32.2">32.2</td>
                        <td><div class="status-badge badge-caution">Caution</div></td>
                    </tr>
                    <tr class="status-warning">
                        <td title="20/03/25">20/03/25</td>
                        <td title="15/05/25 08:00">15/05/25 08:00</td>
                        <td title="JOST24120338">JOST24120338</td>
                        <td title="JOST24120338_CP08-353&CP08-354-P03-05">JOST24120338_CP08-353&CP08-354-P03-05</td>
                        <td title="ST-4">ST-4</td>
                        <td title="PP20-110T">PP20-110T</td>
                        <td title="1">1</td>
                        <td title="2800">2800</td>
                        <td title="300">300</td>
                        <td title="3">3</td>
                        <td title="9.3">9.3</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="0.0">0.0</td>
                        <td title="2800">2800</td>
                        <td title="2025-05-14 09:10">2025-05-14 09:10</td>
                        <td title="2025-05-14 18:30">2025-05-14 18:30</td>
                        <td title="13.5">13.5</td>
                        <td><div class="status-badge badge-warning">Warning</div></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.25/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script>
        $(document).ready(function() {
            // Initialize DataTables with improved options
            $('#scheduleTable').DataTable({
                order: [[1, 'asc']], // Sort by LCD_DATE by default (column index 1), showing latest dates first
                pageLength: 25,
                lengthMenu: [10, 25, 50, 100, 200],
                responsive: true,
                scrollX: true,  // Enable horizontal scrolling
                scrollCollapse: true,
                autoWidth: false, // Don't auto-calculate widths
                columnDefs: [
                    // Set column visibility and width options
                    { "width": "90px", "targets": 0 }, // LCD_DATE
                    { "width": "95px", "targets": 1 }, // JOB
                    { "width": "120px", "targets": 2 }, // UNIQUE_JOB_ID
                    { "width": "65px", "targets": 3 }, // RSC_LOCATION
                    { "width": "80px", "targets": 4 }, // RSC_CODE
                    { "width": "60px", "targets": 5 }, // NUMBER_OPERATOR
                    { "width": "70px", "targets": 6 }, // JOB_QUANTITY
                    { "width": "75px", "targets": 7 }, // EXPECT_OUTPUT_PER_HOUR
                    { "width": "50px", "targets": 8 }, // PRIORITY
                    { "width": "60px", "targets": 9 }, // HOURS_NEED
                    { "width": "65px", "targets": 10 }, // SETTING_HOURS
                    { "width": "65px", "targets": 11 }, // BREAK_HOURS
                    { "width": "50px", "targets": 12 }, // NO_PROD
                    { "width": "90px", "targets": 13 }, // START_DATE
                    { "width": "80px", "targets": 14 }, // ACCUMULATED_DAILY_OUTPUT
                    { "width": "70px", "targets": 15 }, // BALANCE_QUANTITY
                    { "width": "90px", "targets": 16 }, // START_TIME
                    { "width": "90px", "targets": 17 }, // END_TIME
                    { "width": "50px", "targets": 18 }, // BAL_HR
                    { "width": "70px", "targets": 19 }  // BUFFER_STATUS
                ],
                dom: 'Bfrtip',
                buttons: [
                    {
                        extend: 'colvis',
                        text: '<i class="bi bi-eye me-1"></i> Show/Hide Columns',
                        className: 'btn btn-sm btn-secondary mb-2',
                        // Show this button first
                        postfixButtons: ['colvisRestore']
                    },
                    {
                        extend: 'excel',
                        text: '<i class="bi bi-file-earmark-excel me-1"></i> Excel',
                        className: 'btn btn-sm btn-success',
                        exportOptions: {
                            columns: ':visible'
                        }
                    },
                    {
                        extend: 'csv',
                        text: '<i class="bi bi-file-earmark-text me-1"></i> CSV',
                        className: 'btn btn-sm btn-info',
                        exportOptions: {
                            columns: ':visible'
                        }
                    },
                    {
                        extend: 'pdf',
                        text: '<i class="bi bi-file-earmark-pdf me-1"></i> PDF',
                        className: 'btn btn-sm btn-danger',
                        exportOptions: {
                            columns: ':visible'
                        }
                    }
                ],
                initComplete: function () {
                    // Add a legend at the top
                    var legendHtml = '<div class="mb-3 p-2 bg-white rounded shadow-sm" style="font-size: 11px;">' +
                        '<h5 class="border-bottom pb-2 mb-2" style="font-size: 14px;"><i class="bi bi-info-circle me-2"></i>Buffer Status Legend:</h5>' +
                        '<div class="d-flex flex-wrap gap-2">' +
                        '<div class="status-badge badge-critical">Late (<8h)</div>' +
                        '<div class="status-badge badge-warning">Warning (<24h)</div>' +
                        '<div class="status-badge badge-caution">Caution (<72h)</div>' +
                        '<div class="status-badge badge-ok">OK (>72h)</div>' +
                        '</div></div>';
                    $('.dataTables_wrapper').prepend(legendHtml);
                }
            });
        });
        
        function exportTableToCSV(filename) {
            var csv = [];
            var rows = document.querySelectorAll("table tr");
            
            for (var i = 0; i < rows.length; i++) {
                var row = [], cols = rows[i].querySelectorAll("td, th");
                
                for (var j = 0; j < cols.length; j++) {
                    // Get the text content, handling the case of the status badge
                    var text = cols[j].innerText;
                    if (cols[j].querySelector('.status-badge')) {
                        text = cols[j].querySelector('.status-badge').innerText;
                    }
                    row.push('"' + text.replace(/"/g, '""') + '"');
                }
                
                csv.push(row.join(","));
            }
            
            // Download CSV file
            downloadCSV(csv.join("\n"), filename);
        }
        
        function downloadCSV(csv, filename) {
            var csvFile = new Blob([csv], {type: "text/csv"});
            var downloadLink = document.createElement("a");
            
            // File name
            downloadLink.download = filename;
            
            // Create a link to the file
            downloadLink.href = window.URL.createObjectURL(csvFile);
            
            // Hide download link
            downloadLink.style.display = "none";
            
            // Add the link to DOM
            document.body.appendChild(downloadLink);
            
            // Click download link
            downloadLink.click();
            
            // Remove the link
            document.body.removeChild(downloadLink);
        }
    </script>
</body>
</html>