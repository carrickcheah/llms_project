<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Production Scheduler</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.25/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.2.2/css/buttons.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.9/css/responsive.bootstrap5.min.css">
    <style>
        body { 
            font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; 
            background-color: #f5f7fa;
            color: #333;
        }
        .container-fluid {
            max-width: 1400px;
            margin: 0 auto;
        }
        .dashboard {
            margin-bottom: 20px; 
            padding: 15px; 
            border-radius: 8px; 
            background: #fff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border: 1px solid #eaeaea;
        }
        .dashboard h3 {
            margin-top: 0;
            font-weight: 600;
            color: #3a3a3a;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
            margin-bottom: 12px;
            font-size: 16px;
        }
        table.dataTable {
            border-collapse: separate !important;
            border-spacing: 0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            font-size: 10px;  /* Smaller base font size */
            width: 100%;
            table-layout: fixed;  /* Fixed table layout for better control */
            margin: 0;
            padding: 0;
        }
        
        table.dataTable th {
            font-size: 9px;  /* Extra small header font */
            padding: 1px 2px !important;  /* Minimal padding */
            font-weight: 600;
            white-space: nowrap;  /* Prevent wrapping in headers */
            overflow: hidden;
            text-overflow: ellipsis;  /* Show ellipsis for overflow */
        }
        
        table.dataTable td {
            font-size: 10px;  /* Extra small cell font */
            padding: 1px 2px !important;  /* Minimal padding */
            overflow: hidden;
            text-overflow: ellipsis;  /* Show ellipsis for overflow */
            white-space: normal;  /* Allow text to wrap */
        }
        
        /* Set specific column widths based on content - reduced to fit all columns */
        table.dataTable th:nth-child(1), table.dataTable td:nth-child(1) { width: 40px; } /* PLAN_DATE */
        table.dataTable th:nth-child(2), table.dataTable td:nth-child(2) { width: 55px; } /* LCD_DATE */
        table.dataTable th:nth-child(3), table.dataTable td:nth-child(3) { width: 60px; } /* JOB */
        table.dataTable th:nth-child(4), table.dataTable td:nth-child(4) { width: 100px; } /* UNIQUE_JOB_ID */
        table.dataTable th:nth-child(5), table.dataTable td:nth-child(5) { width: 40px; } /* RSC_LOCATION */
        table.dataTable th:nth-child(6), table.dataTable td:nth-child(6) { width: 55px; } /* RSC_CODE */
        table.dataTable th:nth-child(7), table.dataTable td:nth-child(7) { width: 35px; } /* NUMBER_OPERATOR */
        table.dataTable th:nth-child(8), table.dataTable td:nth-child(8) { width: 45px; } /* JOB_QUANTITY */
        table.dataTable th:nth-child(9), table.dataTable td:nth-child(9) { width: 45px; } /* EXPECT_OUTPUT_PER_HOUR */
        table.dataTable th:nth-child(10), table.dataTable td:nth-child(10) { width: 25px; } /* PRIORITY */
        table.dataTable th:nth-child(11), table.dataTable td:nth-child(11) { width: 40px; } /* HOURS_NEED */
        table.dataTable th:nth-child(12), table.dataTable td:nth-child(12) { width: 45px; } /* SETTING_HOURS */
        table.dataTable th:nth-child(13), table.dataTable td:nth-child(13) { width: 45px; } /* BREAK_HOURS */
        table.dataTable th:nth-child(14), table.dataTable td:nth-child(14) { width: 35px; } /* NO_PROD */
        table.dataTable th:nth-child(15), table.dataTable td:nth-child(15) { width: 65px; } /* START_DATE */
        table.dataTable th:nth-child(16), table.dataTable td:nth-child(16) { width: 55px; } /* ACCUMULATED_DAILY_OUTPUT */
        table.dataTable th:nth-child(17), table.dataTable td:nth-child(17) { width: 45px; } /* BALANCE_QUANTITY */
        table.dataTable th:nth-child(18), table.dataTable td:nth-child(18) { width: 65px; } /* START_TIME */
        table.dataTable th:nth-child(19), table.dataTable td:nth-child(19) { width: 65px; } /* END_TIME */
        table.dataTable th:nth-child(20), table.dataTable td:nth-child(20) { width: 35px; } /* BAL_HR */
        table.dataTable th:nth-child(21), table.dataTable td:nth-child(21) { width: 50px; } /* BUFFER_STATUS */
        
        /* Make table container scrollable horizontally */
        .table-container {
            overflow-x: visible;
            margin-bottom: 30px;
            width: 100%;
        }
        
        /* Highlight row on hover for better readability */
        table.dataTable tbody tr:hover {
            background-color: rgba(0, 123, 255, 0.05) !important;
        }
        
        /* Status styles */
        .status-critical { background-color: rgba(255, 0, 0, 0.05); }
        .status-warning { background-color: rgba(255, 190, 0, 0.05); }
        .status-caution { background-color: rgba(128, 0, 128, 0.05); }
        .status-ok { background-color: rgba(0, 128, 0, 0.05); }
        
        .status-badge {
            display: inline-block;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 600;
            text-align: center;
            width: 100%;
            font-size: 10px;
        }
        
        .badge-critical { background-color: #ffcccc; color: #cc0000; border: 1px solid #ff8080; }
        .badge-warning { background-color: #fff2cc; color: #b38600; border: 1px solid #ffdb4d; }
        .badge-caution { background-color: #f0d6f0; color: #800080; border: 1px solid #d699d6; }
        .badge-ok { background-color: #d6f0d6; color: #006600; border: 1px solid #99d699; }
    </style>
</head>
<body>
    <div class="container-fluid" style="max-width: 100%; padding: 10px;">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h1 class="mb-0" style="font-size: 20px;"><i class="bi bi-calendar-check me-2"></i>Production Scheduler</h1>
            <div>
                <button class="btn btn-sm btn-primary" onclick="window.print()">
                    <i class="bi bi-printer me-1"></i> Print
                </button>
                <button class="btn btn-sm btn-outline-secondary ms-2" onclick="exportTableToCSV('production_schedule.csv')">
                    <i class="bi bi-download me-1"></i> Export
                </button>
            </div>
        </div>
        
        <div class="dashboard row">
            <div class="col-md-6">
                <h3>Schedule Overview</h3>
                <p style="font-size: 12px;"><strong>Total Jobs:</strong> 15</p>
                <p style="font-size: 12px;"><strong>Date Range:</strong> 2025-04-10 08:00 to 2025-06-06 07:21</p>
                <p style="font-size: 12px;"><strong>Total Duration:</strong> 1367.3504617604617 hours</p>
            </div>
            <div class="col-md-6">
                <h3>Buffer Status</h3>
                <div class="d-flex flex-column gap-2">
                    <div class="d-flex align-items-center">
                        <div class="status-badge badge-critical me-2" style="width: 80px;">Late</div>
                        <div class="progress flex-grow-1" style="height: 16px;">
                            <div class="progress-bar bg-danger" role="progressbar" 
                                style="width: 46.666666666666664%;" 
                                aria-valuenow="7" 
                                aria-valuemin="0" aria-valuemax="15">
                                7 jobs
                            </div>
                        </div>
                    </div>
                    <div class="d-flex align-items-center">
                        <div class="status-badge badge-warning me-2" style="width: 80px;">Warning</div>
                        <div class="progress flex-grow-1" style="height: 16px;">
                            <div class="progress-bar bg-warning text-dark" role="progressbar" 
                                style="width: 6.666666666666667%;" 
                                aria-valuenow="1" 
                                aria-valuemin="0" aria-valuemax="15">
                                1 jobs
                            </div>
                        </div>
                    </div>
                    <div class="d-flex align-items-center">
                        <div class="status-badge badge-caution me-2" style="width: 80px;">Caution</div>
                        <div class="progress flex-grow-1" style="height: 16px;">
                            <div class="progress-bar" role="progressbar" style="background-color: purple; width: 26.666666666666668%;" 
                                aria-valuenow="4" 
                                aria-valuemin="0" aria-valuemax="15">
                                4 jobs
                            </div>
                        </div>
                    </div>
                    <div class="d-flex align-items-center">
                        <div class="status-badge badge-ok me-2" style="width: 80px;">OK</div>
                        <div class="progress flex-grow-1" style="height: 16px;">
                            <div class="progress-bar bg-success" role="progressbar" 
                                style="width: 20.0%;" 
                                aria-valuenow="3" 
                                aria-valuemin="0" aria-valuemax="15">
                                3 jobs
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="table-container">
            <h2 style="font-size: 16px; margin-bottom: 10px;">Production Jobs</h2>
            <table id="scheduleTable" class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th>PLAN_DATE</th>
                        <th>LCD_DATE</th>
                        <th>JOB</th>
                        <th>UNIQUE_JOB_ID</th>
                        <th>RSC_LOCATION</th>
                        <th>RSC_CODE</th>
                        <th>NUMBER_OPERATOR</th>
                        <th>JOB_QUANTITY</th>
                        <th>EXPECT_OUTPUT_PER_HOUR</th>
                        <th>PRIORITY</th>
                        <th>HOURS_NEED</th>
                        <th>SETTING_HOURS</th>
                        <th>BREAK_HOURS</th>
                        <th>NO_PROD</th>
                        <th>START_DATE</th>
                        <th>ACCUMULATED_DAILY_OUTPUT</th>
                        <th>BALANCE_QUANTITY</th>
                        <th>START_TIME</th>
                        <th>END_TIME</th>
                        <th>BAL_HR</th>
                        <th>BUFFER_STATUS</th>
                    </tr>
                </thead>
                <tbody>

                    <tr class="status-ok">
                        <td title="01/03/25">01/03/25</td>
                        <td title="15/04/25 17:00">15/04/25 17:00</td>
                        <td title="JOST111111">JOST111111</td>
                        <td title="JOST111111_CP11-111-P01-08">JOST111111_CP11-111-P01-08</td>
                        <td title="TR">TR</td>
                        <td title="PAINTING">PAINTING</td>
                        <td title="1">1</td>
                        <td title="10000">10000</td>
                        <td title="500">500</td>
                        <td title="3">3</td>
                        <td title="20.0">20.0</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title="2025-04-10 08:00">2025-04-10 08:00</td>
                        <td title="1000">1000</td>
                        <td title="9000">9000</td>
                        <td title="2025-04-10 08:00">2025-04-10 08:00</td>
                        <td title="2025-04-11 04:00">2025-04-11 04:00</td>
                        <td title="109.0">109.0</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-ok">
                        <td title="01/03/25">01/03/25</td>
                        <td title="15/04/25 17:00">15/04/25 17:00</td>
                        <td title="JOST111111">JOST111111</td>
                        <td title="JOST111111_CP11-111-P02-09">JOST111111_CP11-111-P02-09</td>
                        <td title="TR">TR</td>
                        <td title="PAINTING">PAINTING</td>
                        <td title="1">1</td>
                        <td title="20000">20000</td>
                        <td title="600">600</td>
                        <td title="3">3</td>
                        <td title="33.3">33.3</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="2000">2000</td>
                        <td title="18000">18000</td>
                        <td title="2025-04-11 04:00">2025-04-11 04:00</td>
                        <td title="2025-04-12 13:20">2025-04-12 13:20</td>
                        <td title="75.7">75.7</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-caution">
                        <td title="01/03/25">01/03/25</td>
                        <td title="15/04/25 17:00">15/04/25 17:00</td>
                        <td title="JOST111111">JOST111111</td>
                        <td title="JOST111111_CP11-111-P03-10">JOST111111_CP11-111-P03-10</td>
                        <td title="TR">TR</td>
                        <td title="PAINTING">PAINTING</td>
                        <td title="1">1</td>
                        <td title="10000">10000</td>
                        <td title="700">700</td>
                        <td title="3">3</td>
                        <td title="14.3">14.3</td>
                        <td title="2.0">2.0</td>
                        <td title="1.0">1.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="3000">3000</td>
                        <td title="7000">7000</td>
                        <td title="2025-04-12 13:20">2025-04-12 13:20</td>
                        <td title="2025-04-13 03:37">2025-04-13 03:37</td>
                        <td title="61.4">61.4</td>
                        <td><div class="status-badge badge-caution">Caution</div></td>
                    </tr>
                    <tr class="status-caution">
                        <td title="01/03/25">01/03/25</td>
                        <td title="15/04/25 17:00">15/04/25 17:00</td>
                        <td title="JOST111111">JOST111111</td>
                        <td title="JOST111111_CP11-111-P04-11">JOST111111_CP11-111-P04-11</td>
                        <td title="TR">TR</td>
                        <td title="PAINTING">PAINTING</td>
                        <td title="1">1</td>
                        <td title="15000">15000</td>
                        <td title="800">800</td>
                        <td title="3">3</td>
                        <td title="18.8">18.8</td>
                        <td title="2.0">2.0</td>
                        <td title="1.0">1.0</td>
                        <td title="6.0">6.0</td>
                        <td title=""></td>
                        <td title="4000">4000</td>
                        <td title="11000">11000</td>
                        <td title="2025-04-13 03:37">2025-04-13 03:37</td>
                        <td title="2025-04-13 22:22">2025-04-13 22:22</td>
                        <td title="42.6">42.6</td>
                        <td><div class="status-badge badge-caution">Caution</div></td>
                    </tr>
                    <tr class="status-caution">
                        <td title="01/03/25">01/03/25</td>
                        <td title="15/04/25 17:00">15/04/25 17:00</td>
                        <td title="JOST111111">JOST111111</td>
                        <td title="JOST111111_CP11-111-P05-12">JOST111111_CP11-111-P05-12</td>
                        <td title="TR">TR</td>
                        <td title="CHECKING">CHECKING</td>
                        <td title="1">1</td>
                        <td title="10000">10000</td>
                        <td title="900">900</td>
                        <td title="3">3</td>
                        <td title="11.1">11.1</td>
                        <td title="3.0">3.0</td>
                        <td title="2.0">2.0</td>
                        <td title="6.0">6.0</td>
                        <td title=""></td>
                        <td title="5000">5000</td>
                        <td title="5000">5000</td>
                        <td title="2025-04-13 22:22">2025-04-13 22:22</td>
                        <td title="2025-04-14 09:28">2025-04-14 09:28</td>
                        <td title="31.5">31.5</td>
                        <td><div class="status-badge badge-caution">Caution</div></td>
                    </tr>
                    <tr class="status-warning">
                        <td title="01/03/25">01/03/25</td>
                        <td title="15/04/25 17:00">15/04/25 17:00</td>
                        <td title="JOST111111">JOST111111</td>
                        <td title="JOST111111_CP11-111-P06-13">JOST111111_CP11-111-P06-13</td>
                        <td title="ST-4">ST-4</td>
                        <td title="TW01">TW01</td>
                        <td title="1">1</td>
                        <td title="13000">13000</td>
                        <td title="1000">1000</td>
                        <td title="3">3</td>
                        <td title="13.0">13.0</td>
                        <td title="3.0">3.0</td>
                        <td title="2.0">2.0</td>
                        <td title="6.0">6.0</td>
                        <td title=""></td>
                        <td title="3000">3000</td>
                        <td title="10000">10000</td>
                        <td title="2025-04-14 09:28">2025-04-14 09:28</td>
                        <td title="2025-04-14 22:28">2025-04-14 22:28</td>
                        <td title="18.5">18.5</td>
                        <td><div class="status-badge badge-warning">Warning</div></td>
                    </tr>
                    <tr class="status-ok">
                        <td title="01/03/25">01/03/25</td>
                        <td title="01/05/25 08:00">01/05/25 08:00</td>
                        <td title="JOB2222222">JOB2222222</td>
                        <td title="JOB2222222_CD22-222-P02-07">JOB2222222_CD22-222-P02-07</td>
                        <td title="ST-4">ST-4</td>
                        <td title="TW01">TW01</td>
                        <td title="1">1</td>
                        <td title="41613">41613</td>
                        <td title="300">300</td>
                        <td title="3">3</td>
                        <td title="138.7">138.7</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="17400">17400</td>
                        <td title="24213">24213</td>
                        <td title="2025-04-14 22:28">2025-04-14 22:28</td>
                        <td title="2025-04-20 17:11">2025-04-20 17:11</td>
                        <td title="254.8">254.8</td>
                        <td><div class="status-badge badge-ok">OK</div></td>
                    </tr>
                    <tr class="status-caution">
                        <td title="01/03/25">01/03/25</td>
                        <td title="01/05/25 10:00">01/05/25 10:00</td>
                        <td title="JOB2222222">JOB2222222</td>
                        <td title="JOB2222222_CD22-222-P03-08">JOB2222222_CD22-222-P03-08</td>
                        <td title="WN">WN</td>
                        <td title="PAINTING">PAINTING</td>
                        <td title="1">1</td>
                        <td title="15000">15000</td>
                        <td title="80">80</td>
                        <td title="3">3</td>
                        <td title="187.5">187.5</td>
                        <td title="1.0">1.0</td>
                        <td title="1.0">1.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="2000">2000</td>
                        <td title="13000">13000</td>
                        <td title="2025-04-20 17:11">2025-04-20 17:11</td>
                        <td title="2025-04-28 12:41">2025-04-28 12:41</td>
                        <td title="69.3">69.3</td>
                        <td><div class="status-badge badge-caution">Caution</div></td>
                    </tr>
                    <tr class="status-critical">
                        <td title="01/03/25">01/03/25</td>
                        <td title="01/05/25 11:00">01/05/25 11:00</td>
                        <td title="JOB2222222">JOB2222222</td>
                        <td title="JOB2222222_CD22-222-P04-03">JOB2222222_CD22-222-P04-03</td>
                        <td title="AL">AL</td>
                        <td title="VM04">VM04</td>
                        <td title="1">1</td>
                        <td title="100806">100806</td>
                        <td title="550">550</td>
                        <td title="3">3</td>
                        <td title="183.3">183.3</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="10.0">10.0</td>
                        <td title=""></td>
                        <td title="9000">9000</td>
                        <td title="91806">91806</td>
                        <td title="2025-04-28 12:41">2025-04-28 12:41</td>
                        <td title="2025-05-06 03:58">2025-05-06 03:58</td>
                        <td title="-113.0">-113.0</td>
                        <td><div class="status-badge badge-critical">Late</div></td>
                    </tr>
                    <tr class="status-critical">
                        <td title="01/03/25">01/03/25</td>
                        <td title="01/05/25 12:00">01/05/25 12:00</td>
                        <td title="JOB2222222">JOB2222222</td>
                        <td title="JOB2222222_CD22-222-P05-01">JOB2222222_CD22-222-P05-01</td>
                        <td title="TR">TR</td>
                        <td title="Checking">Checking</td>
                        <td title="1">1</td>
                        <td title="100806">100806</td>
                        <td title="600">600</td>
                        <td title="3">3</td>
                        <td title="168.0">168.0</td>
                        <td title="2.0">2.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="57547">57547</td>
                        <td title="43259">43259</td>
                        <td title="2025-05-06 03:58">2025-05-06 03:58</td>
                        <td title="2025-05-13 03:59">2025-05-13 03:59</td>
                        <td title="-280.0">-280.0</td>
                        <td><div class="status-badge badge-critical">Late</div></td>
                    </tr>
                    <tr class="status-critical">
                        <td title="01/03/25">01/03/25</td>
                        <td title="05/05/25 13:00">05/05/25 13:00</td>
                        <td title="JOST333333">JOST333333</td>
                        <td title="JOST333333_CP33-333-P01-02">JOST333333_CP33-333-P01-02</td>
                        <td title="TR">TR</td>
                        <td title="Checking">Checking</td>
                        <td title="1">1</td>
                        <td title="1000">1000</td>
                        <td title="10">10</td>
                        <td title="3">3</td>
                        <td title="100.0">100.0</td>
                        <td title="2.0">2.0</td>
                        <td title="2.0">2.0</td>
                        <td title="10.0">10.0</td>
                        <td title=""></td>
                        <td title="428">428</td>
                        <td title="572">572</td>
                        <td title="2025-05-13 03:59">2025-05-13 03:59</td>
                        <td title="2025-05-17 07:59">2025-05-17 07:59</td>
                        <td title="-283.0">-283.0</td>
                        <td><div class="status-badge badge-critical">Late</div></td>
                    </tr>
                    <tr class="status-critical">
                        <td title="01/03/25">01/03/25</td>
                        <td title="05/05/25 14:00">05/05/25 14:00</td>
                        <td title="JOST333333">JOST333333</td>
                        <td title="JOST333333_CP33-333-P02-03">JOST333333_CP33-333-P02-03</td>
                        <td title="TR">TR</td>
                        <td title="VM02">VM02</td>
                        <td title="1">1</td>
                        <td title="5000">5000</td>
                        <td title="50">50</td>
                        <td title="3">3</td>
                        <td title="100.0">100.0</td>
                        <td title="2.0">2.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="2000">2000</td>
                        <td title="3000">3000</td>
                        <td title="2025-05-17 07:59">2025-05-17 07:59</td>
                        <td title="2025-05-21 11:59">2025-05-21 11:59</td>
                        <td title="-382.0">-382.0</td>
                        <td><div class="status-badge badge-critical">Late</div></td>
                    </tr>
                    <tr class="status-critical">
                        <td title="01/03/25">01/03/25</td>
                        <td title="05/05/25 15:00">05/05/25 15:00</td>
                        <td title="JOST333333">JOST333333</td>
                        <td title="JOST333333_CP33-333-P03-11">JOST333333_CP33-333-P03-11</td>
                        <td title="AL">AL</td>
                        <td title="VM03">VM03</td>
                        <td title="1">1</td>
                        <td title="30120">30120</td>
                        <td title="100">100</td>
                        <td title="3">3</td>
                        <td title="301.2">301.2</td>
                        <td title="2.0">2.0</td>
                        <td title="1.0">1.0</td>
                        <td title="6.0">6.0</td>
                        <td title=""></td>
                        <td title="1000">1000</td>
                        <td title="29120">29120</td>
                        <td title="2025-05-21 11:59">2025-05-21 11:59</td>
                        <td title="2025-06-03 01:11">2025-06-03 01:11</td>
                        <td title="-682.2">-682.2</td>
                        <td><div class="status-badge badge-critical">Late</div></td>
                    </tr>
                    <tr class="status-critical">
                        <td title="01/03/25">01/03/25</td>
                        <td title="05/05/25 16:00">05/05/25 16:00</td>
                        <td title="JOST333333">JOST333333</td>
                        <td title="JOST333333_CP33-333-P04-05">JOST333333_CP33-333-P04-05</td>
                        <td title="TR">TR</td>
                        <td title="VM04">VM04</td>
                        <td title="1">1</td>
                        <td title="2520">2520</td>
                        <td title="80">80</td>
                        <td title="3">3</td>
                        <td title="31.5">31.5</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="8.0">8.0</td>
                        <td title=""></td>
                        <td title="211">211</td>
                        <td title="2309">2309</td>
                        <td title="2025-06-03 01:11">2025-06-03 01:11</td>
                        <td title="2025-06-04 08:41">2025-06-04 08:41</td>
                        <td title="-712.7">-712.7</td>
                        <td><div class="status-badge badge-critical">Late</div></td>
                    </tr>
                    <tr class="status-critical">
                        <td title="01/03/25">01/03/25</td>
                        <td title="05/05/25 17:00">05/05/25 17:00</td>
                        <td title="JOST333333">JOST333333</td>
                        <td title="JOST333333_CP33-333-P05-02">JOST333333_CP33-333-P05-02</td>
                        <td title="WN">WN</td>
                        <td title="PAINTING">PAINTING</td>
                        <td title="1">1</td>
                        <td title="2800">2800</td>
                        <td title="60">60</td>
                        <td title="3">3</td>
                        <td title="46.7">46.7</td>
                        <td title="1.0">1.0</td>
                        <td title="2.0">2.0</td>
                        <td title="10.0">10.0</td>
                        <td title=""></td>
                        <td title="182">182</td>
                        <td title="2618">2618</td>
                        <td title="2025-06-04 08:41">2025-06-04 08:41</td>
                        <td title="2025-06-06 07:21">2025-06-06 07:21</td>
                        <td title="-758.4">-758.4</td>
                        <td><div class="status-badge badge-critical">Late</div></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.25/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script>
        $(document).ready(function() {
            // Initialize DataTables with improved options
            $('#scheduleTable').DataTable({
                order: [[1, 'asc']], // Sort by LCD_DATE by default (column index 1), showing latest dates first
                pageLength: 25,
                lengthMenu: [10, 25, 50, 100, 200],
                responsive: true,
                scrollX: true,  // Enable horizontal scrolling
                scrollCollapse: true,
                autoWidth: false, // Don't auto-calculate widths
                columnDefs: [
                    // Set column visibility and width options
                    { "width": "90px", "targets": 0 }, // LCD_DATE
                    { "width": "95px", "targets": 1 }, // JOB
                    { "width": "120px", "targets": 2 }, // UNIQUE_JOB_ID
                    { "width": "65px", "targets": 3 }, // RSC_LOCATION
                    { "width": "80px", "targets": 4 }, // RSC_CODE
                    { "width": "60px", "targets": 5 }, // NUMBER_OPERATOR
                    { "width": "70px", "targets": 6 }, // JOB_QUANTITY
                    { "width": "75px", "targets": 7 }, // EXPECT_OUTPUT_PER_HOUR
                    { "width": "50px", "targets": 8 }, // PRIORITY
                    { "width": "60px", "targets": 9 }, // HOURS_NEED
                    { "width": "65px", "targets": 10 }, // SETTING_HOURS
                    { "width": "65px", "targets": 11 }, // BREAK_HOURS
                    { "width": "50px", "targets": 12 }, // NO_PROD
                    { "width": "90px", "targets": 13 }, // START_DATE
                    { "width": "80px", "targets": 14 }, // ACCUMULATED_DAILY_OUTPUT
                    { "width": "70px", "targets": 15 }, // BALANCE_QUANTITY
                    { "width": "90px", "targets": 16 }, // START_TIME
                    { "width": "90px", "targets": 17 }, // END_TIME
                    { "width": "50px", "targets": 18 }, // BAL_HR
                    { "width": "70px", "targets": 19 }  // BUFFER_STATUS
                ],
                dom: 'Bfrtip',
                buttons: [
                    {
                        extend: 'colvis',
                        text: '<i class="bi bi-eye me-1"></i> Show/Hide Columns',
                        className: 'btn btn-sm btn-secondary mb-2',
                        // Show this button first
                        postfixButtons: ['colvisRestore']
                    },
                    {
                        extend: 'excel',
                        text: '<i class="bi bi-file-earmark-excel me-1"></i> Excel',
                        className: 'btn btn-sm btn-success',
                        exportOptions: {
                            columns: ':visible'
                        }
                    },
                    {
                        extend: 'csv',
                        text: '<i class="bi bi-file-earmark-text me-1"></i> CSV',
                        className: 'btn btn-sm btn-info',
                        exportOptions: {
                            columns: ':visible'
                        }
                    },
                    {
                        extend: 'pdf',
                        text: '<i class="bi bi-file-earmark-pdf me-1"></i> PDF',
                        className: 'btn btn-sm btn-danger',
                        exportOptions: {
                            columns: ':visible'
                        }
                    }
                ],
                initComplete: function () {
                    // Add a legend at the top
                    var legendHtml = '<div class="mb-3 p-2 bg-white rounded shadow-sm" style="font-size: 11px;">' +
                        '<h5 class="border-bottom pb-2 mb-2" style="font-size: 14px;"><i class="bi bi-info-circle me-2"></i>Buffer Status Legend:</h5>' +
                        '<div class="d-flex flex-wrap gap-2">' +
                        '<div class="status-badge badge-critical">Late (<8h)</div>' +
                        '<div class="status-badge badge-warning">Warning (<24h)</div>' +
                        '<div class="status-badge badge-caution">Caution (<72h)</div>' +
                        '<div class="status-badge badge-ok">OK (>72h)</div>' +
                        '</div></div>';
                    $('.dataTables_wrapper').prepend(legendHtml);
                }
            });
        });
        
        function exportTableToCSV(filename) {
            var csv = [];
            var rows = document.querySelectorAll("table tr");
            
            for (var i = 0; i < rows.length; i++) {
                var row = [], cols = rows[i].querySelectorAll("td, th");
                
                for (var j = 0; j < cols.length; j++) {
                    // Get the text content, handling the case of the status badge
                    var text = cols[j].innerText;
                    if (cols[j].querySelector('.status-badge')) {
                        text = cols[j].querySelector('.status-badge').innerText;
                    }
                    row.push('"' + text.replace(/"/g, '""') + '"');
                }
                
                csv.push(row.join(","));
            }
            
            // Download CSV file
            downloadCSV(csv.join("\n"), filename);
        }
        
        function downloadCSV(csv, filename) {
            var csvFile = new Blob([csv], {type: "text/csv"});
            var downloadLink = document.createElement("a");
            
            // File name
            downloadLink.download = filename;
            
            // Create a link to the file
            downloadLink.href = window.URL.createObjectURL(csvFile);
            
            // Hide download link
            downloadLink.style.display = "none";
            
            // Add the link to DOM
            document.body.appendChild(downloadLink);
            
            // Click download link
            downloadLink.click();
            
            // Remove the link
            document.body.removeChild(downloadLink);
        }
    </script>
</body>
</html>